(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-478cb974"],{"361a":function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:t.queryParams,size:"small",inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"考试批次",prop:"testId"}},[a("el-select",{attrs:{placeholder:"请选择考试批次",clearable:""},model:{value:t.queryParams.testId,callback:function(e){t.$set(t.queryParams,"testId",e)},expression:"queryParams.testId"}},t._l(t.testList,(function(t){return a("el-option",{key:t.testId,attrs:{label:t.testName,value:t.testId}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.handleQuery}},[t._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.resetQuery}},[t._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{directives:[{name:"hasRole",rawName:"v-hasRole",value:["teacher"],expression:"['teacher']"}],attrs:{type:"info",plain:"",icon:"el-icon-upload2",size:"mini"},on:{click:t.handleImport}},[t._v("导入")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.scoreList},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{label:"考试批次",align:"center",prop:"testId","show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[t._l(t.testList,(function(l){return[l.testId===e.row.testId?a("span",[t._v(t._s(l.testName))]):t._e()]}))]}}])}),a("el-table-column",{attrs:{label:"学号",align:"center",prop:"userName"}}),a("el-table-column",{attrs:{label:"姓名",align:"center",prop:"nickName"}}),a("el-table-column",{attrs:{label:"科目",align:"center",prop:"courseName"}}),a("el-table-column",{attrs:{label:"成绩",align:"center",prop:"score"}}),a("el-table-column",{attrs:{label:"备注",align:"center",prop:"remark"}})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}}),a("el-dialog",{attrs:{title:t.title,visible:t.open,width:"500px","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"成绩",prop:"score"}},[a("el-input",{attrs:{placeholder:"请输入成绩"},model:{value:t.form.score,callback:function(e){t.$set(t.form,"score",e)},expression:"form.score"}})],1),a("el-form-item",{attrs:{label:"备注",prop:"remark"}},[a("el-input",{attrs:{placeholder:"请输入备注"},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),a("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1),a("el-dialog",{attrs:{title:t.upload.title,visible:t.upload.open,width:"400px","append-to-body":""},on:{"update:visible":function(e){return t.$set(t.upload,"open",e)}}},[a("el-form",[a("el-form-item",{attrs:{label:"考试批次",prop:"testId"}},[a("el-select",{attrs:{placeholder:"请选择考试批次",clearable:""},model:{value:t.upload.data.testId,callback:function(e){t.$set(t.upload.data,"testId",e)},expression:"upload.data.testId"}},t._l(t.testList,(function(t){return a("el-option",{key:t.testId,attrs:{label:t.testName,value:t.testId}})})),1)],1)],1),a("el-upload",{ref:"upload",attrs:{limit:1,accept:".xlsx, .xls",headers:t.upload.headers,action:t.upload.url,data:t.upload.data,disabled:t.upload.isUploading,"on-progress":t.handleFileUploadProgress,"on-success":t.handleFileSuccess,"auto-upload":!1,drag:""}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),a("em",[t._v("点击上传")])]),a("div",{staticClass:"el-upload__tip text-center",attrs:{slot:"tip"},slot:"tip"},[a("span",[t._v("仅允许导入xls、xlsx格式文件。")])])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitFileForm}},[t._v("确 定")]),a("el-button",{on:{click:function(e){t.upload.open=!1}}},[t._v("取 消")])],1)],1)],1)},n=[],o=a("5530"),s=(a("d81d"),a("a573"),a("b775"));function r(t){return Object(s["a"])({url:"/teaching/score/list",method:"get",params:t})}function i(t){return Object(s["a"])({url:"/teaching/score/"+t,method:"get"})}function u(t){return Object(s["a"])({url:"/teaching/score",method:"post",data:t})}function c(t){return Object(s["a"])({url:"/teaching/score",method:"put",data:t})}function d(t){return Object(s["a"])({url:"/teaching/score/"+t,method:"delete"})}var p=a("5f87"),m=a("b772"),h={name:"Score",dicts:["sys_normal_disable"],data:function(){return{loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,scoreList:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10,testId:null,studentId:null,studentName:null,courseName:null,score:null,status:null},upload:{open:!1,data:{},title:"",isUploading:!1,updateSupport:0,headers:{Authorization:"Bearer "+Object(p["a"])()},url:"/prod-api/teaching/score/importData"},form:{},testList:[],rules:{}}},created:function(){this.getList(),this.getTestList()},methods:{getList:function(){var t=this;this.loading=!0,r(this.queryParams).then((function(e){t.scoreList=e.rows,t.total=e.total,t.loading=!1}))},getTestList:function(){var t=this,e={pageNum:1,pageSize:1e4};Object(m["d"])(e).then((function(e){t.testList=e.rows}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={id:null,testId:null,studentId:null,studentName:null,courseName:null,score:null,status:null,createBy:null,createTime:null,updateBy:null,updateTime:null,remark:null},this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(t){this.ids=t.map((function(t){return t.id})),this.single=1!==t.length,this.multiple=!t.length},handleAdd:function(){this.reset(),this.open=!0,this.title="添加成绩"},handleUpdate:function(t){var e=this;this.reset();var a=t.id||this.ids;i(a).then((function(t){e.form=t.data,e.open=!0,e.title="修改成绩"}))},submitForm:function(){var t=this;this.$refs["form"].validate((function(e){e&&(null!=t.form.id?c(t.form).then((function(e){t.$modal.msgSuccess("修改成功"),t.open=!1,t.getList()})):u(t.form).then((function(e){t.$modal.msgSuccess("新增成功"),t.open=!1,t.getList()})))}))},handleDelete:function(t){var e=this,a=t.id||this.ids;this.$modal.confirm('是否确认删除成绩编号为"'+a+'"的数据项？').then((function(){return d(a)})).then((function(){e.getList(),e.$modal.msgSuccess("删除成功")})).catch((function(){}))},handleExport:function(){this.download("teaching/score/export",Object(o["a"])({},this.queryParams),"score_".concat((new Date).getTime(),".xlsx"))},handleImport:function(){this.upload.title="成绩导入",this.upload.open=!0},importTemplate:function(){this.download("teaching/score/importTemplate",{},"user_template_".concat((new Date).getTime(),".xlsx"))},handleFileUploadProgress:function(t,e,a){this.upload.isUploading=!0},handleFileSuccess:function(t,e,a){this.upload.open=!1,this.upload.isUploading=!1,this.$refs.upload.clearFiles(),this.$alert("<div style='overflow: auto;overflow-x: hidden;max-height: 70vh;padding: 10px 20px 0;'>"+t.msg+"</div>","导入结果",{dangerouslyUseHTMLString:!0}),this.getList()},submitFileForm:function(){this.$refs.upload.submit()}}},f=h,g=a("2877"),b=Object(g["a"])(f,l,n,!1,null,null,null);e["default"]=b.exports},b772:function(t,e,a){"use strict";a.d(e,"d",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return s})),a.d(e,"e",(function(){return r})),a.d(e,"b",(function(){return i}));var l=a("b775");function n(t){return Object(l["a"])({url:"/teaching/test/list",method:"get",params:t})}function o(t){return Object(l["a"])({url:"/teaching/test/"+t,method:"get"})}function s(t){return Object(l["a"])({url:"/teaching/test",method:"post",data:t})}function r(t){return Object(l["a"])({url:"/teaching/test",method:"put",data:t})}function i(t){return Object(l["a"])({url:"/teaching/test/"+t,method:"delete"})}}}]);